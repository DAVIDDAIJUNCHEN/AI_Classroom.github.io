<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>序列区分性训练</title>
    <url>/2021/10/09/paper-0.0.3/chapters/discriminative%20training/</url>
    <content><![CDATA[<p><h1 style="text-align: center"> 序列区分性训练 </h1></p>
<div style="text-align: center"><small>陈代君 - 2021</small></div>

<hr>
<h2 id="1-生成式模型的缺陷"><a href="#1-生成式模型的缺陷" class="headerlink" title="1. 生成式模型的缺陷"></a>1. 生成式模型的缺陷</h2><p>​    语音识别的本质可以下面的公式进行描述，</p>
<script type="math/tex; mode=display">
\max_{S}\mathbb{P}(S|O)</script><p>其中 <script type="math/tex">O</script> 表示观测到的语音信号，<script type="math/tex">S</script> 表示词序列。传统的语音识别进一步分解上面的公式，</p>
<script type="math/tex; mode=display">
\max_{S} \mathbb{P}(S|O) = \max_{S}\frac{\mathbb{P}_{\theta}(O|S)\mathbb{P}(S)}{\mathbb{P}(O)}</script><p>其中，分母 <script type="math/tex">\mathbb{P}(O)</script> 在声音信号给定之后是不需要考虑的常量；分子上 <script type="math/tex">\mathbb{P}(S)</script> 是语言模型， <script type="math/tex">\mathbb{P}_{\theta}(O|S)</script> 是声学模型。 声学模型通常是基于给定的 <script type="math/tex">N</script> 个训练数据 <script type="math/tex">\{( S_{i}, O_{i})\}_{i=1}^{N}</script> 求得 <script type="math/tex">\theta</script> 的极大似然估计。 </p>
<p>为了能够理解极大似然估计的缺陷，先回顾一下极大似然估计。 统计的频率学派将参数 <script type="math/tex">\theta</script> 视为未知的常量，在模型类型给定的基础上，基于训练数据寻找使得似然最大的 <script type="math/tex">\theta</script>，记为 <script type="math/tex">\hat{\theta}_{MLE}</script>， 这个值就是 <script type="math/tex">\theta</script> 的极大似然估计。求极大似然估计的过程中，首先需要给定模型类型，例如在语音识别中，通常假定模型为 GMM-HMM 或者 DNN-HMM。因为真实的语音信号并不是由 HMM 生成的，所以在 GMM-HMM 模型的基础上根据似然最大准则找到的最优参数并不一定使得 WER 或者 SER 最小。 </p>
<p>​    实际上，<script type="math/tex">\mathbb{P}_{\theta}(O|S)</script> 是描述数据分布的生成式模型 (generative model)，即给定词序列，假设观测到的语音信号服从 GMM-HMM 或者 DNN-HMM 模型描述的分布。不同于生成式模型，区分性模型 (discriminative model，也称为判别式模型) 直接对给定观测数据条件下真实类别的分布进行建模。即对 <script type="math/tex">\mathbb{P}_{\theta}(S|O)</script> 进行建模。</p>
<h2 id="3-MMI"><a href="#3-MMI" class="headerlink" title="3. MMI"></a>3. MMI</h2><p>​    因为语音信号随机变量 <script type="math/tex">\mathbf{O}</script> 和词序列随机变量 <script type="math/tex">\mathbf{S}</script> 的互信息如下，</p>
<script type="math/tex; mode=display">
\begin{align}\mathbb{I}(\mathbf{O}, \mathbf{S}) &= \mathbb{E}\log\frac{\mathbb{P}(\mathbf{O},\mathbf{S})}{\mathbb{P}(\mathbf{O})\mathbb{P}(\mathbf{S})}\\
&=\mathbb{H}(\mathbf{S})-\mathbb{H}(\mathbf{S}|\mathbf{O})\end{align}</script><p>其中， <script type="math/tex">\mathbb{H}(\mathbf{S})</script> 表示词序列随机变量的熵，而 <script type="math/tex">\mathbb{H}(\mathbf{S}|\mathbf{O})</script> 表示条件为观测随机变量的条件熵。</p>
<p>​    同时 <script type="math/tex">\mathbb{H}(\mathbf{S})</script> 与待估计模型的参数无关。 所以极大化互信息 <script type="math/tex">\mathbb{I}(\mathbf{O}, \mathbf{S})</script> 等价于极小化条件熵 <script type="math/tex">\mathbb{H}(\mathbf{S}|\mathbf{O})</script>。极小化条件熵意味着在给定观测语音信号随机变量 <script type="math/tex">\mathbf{O}</script> 后，极小化词序列随机变量 <script type="math/tex">\mathbf{S}</script> 的不确定性。 又因为互信息表达式， </p>
<script type="math/tex; mode=display">
\mathbb{I}(\mathbf{O}，\mathbf{S}) = \mathbb{E}\log\frac{\mathbb{P}(\mathbf{O},\mathbf{S})}{\mathbb{P}(\mathbf{O})} - \mathbb{E}\log\mathbb{P}(\mathbf{S})</script><p>其中 <script type="math/tex">\mathbb{P}(\mathbf{S})</script> 不含模型待估参数。 因此，极大化互信息等价于极大化上式右边第一项。所以极大互信息 (MMI, maximum mutual information) 直接求使得 <script type="math/tex">\mathbb{P}_{\theta}(S|O)</script> 极大的 <script type="math/tex">\hat{\theta}_{MMI}</script>，这个估计被称为 MMI 估计。具体的表达式如下，</p>
<script type="math/tex; mode=display">
\begin{align}
\hat{\theta}_{MMI}  &= \arg\max_{\theta} \sum_{i=1}^{N}\log\mathbb{P}_{\theta}(S_{i}|O_{i})\\
&=\arg \max_{\theta}\sum_{i=1}^{N}\log\frac{\mathbb{P}_{\theta}(O_{i}|S_{i})\mathbb{P}(S_{i})}{\mathbb{P}_{\theta}(O_{i})}\\ &=\arg \max_{\theta}\sum_{i=1}^{N}\log\frac{\mathbb{P}_{\theta}(O_{i}|S_{i})\mathbb{P}(S_{i})}{\sum_{j}\mathbb{P}_{\theta}(O_{i}|S_{i}^{j})\mathbb{P}(S_{i}^{j})}
\end{align}</script><p>其中，<script type="math/tex">S_{i}^{j}</script> 表示给定观测语音信号 <script type="math/tex">O_{i}</script> 条件下可能的词序列。例如，当正确的语音为 “动手学语音识别”，则 “冻手雪余音识别” 可以作为其中一个可能的词序列。</p>
<h3 id="3-1-MMI-训练算法推导"><a href="#3-1-MMI-训练算法推导" class="headerlink" title="3.1 MMI 训练算法推导"></a>3.1 MMI 训练算法推导</h3><h3 id="3-2-Lattice-based-MMI"><a href="#3-2-Lattice-based-MMI" class="headerlink" title="3.2 Lattice-based MMI"></a>3.2 Lattice-based MMI</h3><h3 id="3-3-Lattice-free-MMI"><a href="#3-3-Lattice-free-MMI" class="headerlink" title="3.3 Lattice-free MMI"></a>3.3 Lattice-free MMI</h3><h2 id="4-MMI-的拓展"><a href="#4-MMI-的拓展" class="headerlink" title="4. MMI 的拓展"></a>4. MMI 的拓展</h2><h2 id="5-Kaldi-实现"><a href="#5-Kaldi-实现" class="headerlink" title="5. Kaldi 实现"></a>5. Kaldi 实现</h2><h2 id="6-参考资料"><a href="#6-参考资料" class="headerlink" title="6. 参考资料"></a>6. 参考资料</h2><h2 id="Text-Formating"><a href="#Text-Formating" class="headerlink" title="Text Formating"></a>Text Formating</h2><p>Regular, <strong>bold</strong>, <em>italic</em>, <del>strike</del>, ==hightlight==, <code>inline-code</code>,*emphasis^,<!--comment-->,</p>
<h2 id="Cites"><a href="#Cites" class="headerlink" title="Cites"></a>Cites</h2><blockquote>
<p>This is a cite</p>
</blockquote>
<h2 id="Inline-math"><a href="#Inline-math" class="headerlink" title="Inline math:"></a>Inline math:</h2><p>Inline math <script type="math/tex">X^2 + 1 = 1</script> works fine.</p>
<h2 id="Math-Block"><a href="#Math-Block" class="headerlink" title="Math Block:"></a>Math Block:</h2><script type="math/tex; mode=display">
X^2 + 1 = 1</script><h2 id="Tables"><a href="#Tables" class="headerlink" title="Tables:"></a>Tables:</h2><div class="table-container">
<table>
<thead>
<tr>
<th>First Column</th>
<th>Second Column</th>
<th>Third Column</th>
</tr>
</thead>
<tbody>
<tr>
<td>One</td>
<td>Two</td>
<td>Three</td>
</tr>
<tr>
<td>Four</td>
<td>Five</td>
<td>Six</td>
</tr>
</tbody>
</table>
</div>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> someCode <span class="keyword">from</span> <span class="string">&#x27;someLibrary&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><ul>
<li>First item</li>
<li>Second item<ul>
<li>Third item<ul>
<li>Another level</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h2><p><a href="www.google.com">This is a link</a></p>
<h2 id="Footnote"><a href="#Footnote" class="headerlink" title="Footnote"></a>Footnote</h2><p>Some thing </p>
<h2 id="Superscripts"><a href="#Superscripts" class="headerlink" title="Superscripts"></a>Superscripts</h2><p>Example^1^</p>
<p>Example~2~</p>
<h2 id="Images"><a href="#Images" class="headerlink" title="Images"></a>Images</h2><p><img height="300px" src="https://image.freepik.com/vector-gratis/garabatos-ciencia_23-2147501583.jpg"/></p>
<h2 id=""><a href="#" class="headerlink" title=" "></a> </h2>]]></content>
      <categories>
        <category>人工智能</category>
      </categories>
      <tags>
        <tag>语音识别</tag>
      </tags>
  </entry>
</search>
